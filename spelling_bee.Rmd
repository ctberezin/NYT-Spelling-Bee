---
title: "NYT Spelling Bee Solver"
author: "C-T Berezin"
date: "11/9/21"
output:
  pdf_document: default
  html_document: default
---

```{r}
library(tidyverse)
```

```{r word_list}
#all english words
word_list <- read_csv(paste0("https://raw.githubusercontent.com/dwyl",
                             "/english-words/master/words_alpha.txt"),
                      col_names = "word")
word_list <- word_list %>%
  mutate(length = str_length(word)) %>% 
  filter(length >= 4)

#words to remove, weren't accepted in puzzle
nonwords <- c("fluoroformol", "fluoroform", "floramour", "floramor", "formular",
  "furfural", "furfurol", "affloof", "famular", "farfara", "florula",
  "formful", "mafurra", "alfuro", "fallal", "farfal", "faroff",
  "forfar", "formol", "fulful", "fullam", "fullom", "fulmar", "furfur",
  "mafura", "afara", "afoam", "alfur", "falla", "flaff", "fluor", "flurr",
  "foram", "forma", "forra", "froom", "fural", "luffa", "mafoo",  "affa",
  "alfa", "faff", "fala", "fama", "farl", "faro", "flam", "flor", "foll",
  "fram", "frau", "fuff", "fula", "loof", "luff", "moff", "olaf", "olof",
  "raff", "ralf", "rolf")

word_list <- word_list %>% filter(!word %in% nonwords)
```

```{r letters}
center_letter <- "f"
circle_letters <- c("m",
                    "u",
                    "a",
                    "r",
                    "l",
                    "o")
all_letters <- c(center_letter, circle_letters)
```

```{r solve}
solving <- word_list %>%
  #filter to words with center letter
  filter(str_detect(word, center_letter) == TRUE) %>% 
  #break work into letters
  mutate(lets = str_split(word, pattern=""))

solving <- solving %>%
  #check the word's letters against the puzzle's letters
  mutate(match = map(lets, ~.x %in% all_letters, lets=.x)) %>%
 #count number of matching letters
  mutate(matches = map(match, sum)) %>% 
  unnest(matches)

answers <- solving %>%
  #keep words that only use the puzzle's letters
  filter(matches == length) %>% 
  arrange(desc(length))

answers$word
```

```{r pangrams}
pangrams <- answers %>%
  filter(length >= 7) %>% 
  #check the puzzle's letters against the word's letters
  mutate(lets = map(lets, unique)) %>% 
  mutate(pangram = map(lets, ~.x %in% all_letters, lets=.x)) %>%
 #count number of matching letters
  mutate(p_matches = map(pangram, sum)) %>% 
  unnest(p_matches)

pangrams %>%
  #keep words that only use the puzzle's letters
  filter(p_matches == 7) %>% 
  arrange(desc(length)) %>% 
  pull(word)
```
